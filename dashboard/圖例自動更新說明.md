# 圖例自動更新說明

## ✅ 圖例名稱現在完全自動化！

圖例名稱會**直接從 Excel 檔案的欄位名稱讀取**，無需任何手動配置。

## 🎯 工作原理

當你修改 Excel 檔案的欄位名稱時，圖例會自動顯示新的名稱！

### 範例

**Excel 檔案中的欄位：**
- `CS`
- `Si`
- `其它`
- `銷貨毛利率(%)`

**圖例會自動顯示：**
- CS
- Si
- 其它
- 銷貨毛利率(%)

---

## 📝 如何修改圖例名稱

### 步驟 1：修改 Excel 檔案的欄位名稱

在 `財務趨勢模擬資料.xlsx` 中，直接修改欄位名稱：

**修改前：**
| 月份 | CS | Si | 其它 | ...
|------|----|----|------|-----
| 2022-01 | 100 | 200 | 50 | ...

**修改後：**
| 月份 | 消費性電子 | 矽晶圓 | 其它 | ...
|------|-----------|--------|------|-----
| 2022-01 | 100 | 200 | 50 | ...

### 步驟 2：刷新瀏覽器

儲存 Excel 檔案後，重新整理瀏覽器，圖例就會自動顯示新名稱！

**就這麼簡單！** 🎉

---

## 🔧 如果要自訂圖例順序

圖例順序的自訂仍然需要使用 `src/config/legendConfig.js` 配置檔。

### 如何同步更新圖例順序配置

當你修改 Excel 欄位名稱後，如果有使用自訂順序功能，需要同步更新配置檔：

**修改前（Excel 和 legendConfig.js）：**
```javascript
export const legendConfig = {
  chart1: [
    'CS',
    'Si',
    '其它',
    '銷貨毛利率(%)'
  ],
};
```

**修改後（Excel 和 legendConfig.js 都要改）：**
```javascript
export const legendConfig = {
  chart1: [
    '消費性電子',     // 更新這裡
    '矽晶圓',         // 更新這裡
    '其它',
    '銷貨毛利率(%)'
  ],
};
```

詳細說明請參考：`如何調整圖例順序.md`

---

## 📋 各圖表使用的欄位名稱

### 圖一：合併營收淨額與銷貨毛利率
- CS
- Si
- 其它
- 銷貨毛利率(%)

### 圖二：銷貨退回與折讓
- 銷貨退回與折讓(M NTD)
- 佔合併營收總額比重(%)

### 圖三：營業毛利與營業毛利率
- 營業毛利(M NTD)
- 營業毛利率(%)

### 圖四：存貨與跌價損失
- 存貨與跌價損失(M NTD)
- 庫存損失率(%)

### 圖五：閒置產能損失
- 閒置產能損失(M NTD)

### 圖六：營業費用與營業費用率
- 研發費用(M NTD)
- 管理費用(M NTD)
- 銷售費用(M NTD)
- 營業費用率(%)

### 圖七：營業利益與營業利益率
- 營業利益(M NTD)
- 營業利益率(%)

### 圖八：EBITDA與EBITDA率
- EBITDA(M NTD)
- EBITDA率(%)

### 圖九：稅後淨利與稅後淨利率
- 稅後淨利(M NTD)
- 稅後淨利率(%)

---

## ⚠️ 注意事項

1. **Excel 欄位名稱不能刪除**
   - 如果刪除了圖表使用的欄位，圖表將無法顯示
   - 只能修改名稱，不能刪除欄位

2. **固定欄位**
   - `月份` - 必須保留，用於 X 軸
   - `是否為預測` - 必須保留，用於區分歷史/預測數據

3. **名稱一致性**
   - 如果使用自訂圖例順序功能，Excel 欄位名稱和 legendConfig.js 中的名稱必須完全一致

---

## 💡 優勢

✅ **完全自動化** - 圖例名稱直接從 Excel 讀取，無需手動配置

✅ **易於維護** - 修改 Excel 欄位名稱後，圖例自動更新

✅ **彈性十足** - 可以隨時修改 Excel 欄位名稱，不影響程式運作

✅ **零配置** - 不需要維護額外的映射配置檔（除非要自訂順序）

---

## 🎬 快速測試

想要測試自動更新功能嗎？

1. 打開 `財務趨勢模擬資料.xlsx`
2. 修改任一欄位名稱（例如把 `CS` 改成 `消費性電子`）
3. 儲存 Excel 檔案
4. 重新整理瀏覽器
5. 查看圖例是否顯示新名稱 ✨

**就是這麼簡單！**
